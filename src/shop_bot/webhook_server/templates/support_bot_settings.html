{% extends "base.html" %}
{% block title %}Support Bot ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏{% endblock %}

{% block content %}
<h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Support-–±–æ—Ç–∞</h1>

<div class="status-bar">
  <p><strong>–°—Ç–∞—Ç—É—Å:</strong>
    {% if support_bot_status and support_bot_status.is_running %}
      <span class="badge bg-green">–∑–∞–ø—É—â–µ–Ω</span>
    {% else %}
      <span class="badge bg-red">–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</span>
    {% endif %}
  </p>
  <div class="actions">
    <form action="{{ url_for('start_support_bot_route') }}" method="post" style="display:inline-block;">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <button type="submit" class="btn btn-success" {% if not support_settings_ok %}disabled{% endif %}>–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
    </form>
    <form action="{{ url_for('stop_support_bot_route') }}" method="post" style="display:inline-block; margin-left: 8px;">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <button type="submit" class="btn btn-danger">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
    </form>
  </div>
  {% if not support_settings_ok %}
    <p class="hint">–£–∫–∞–∂–∏—Ç–µ —Ç–æ–∫–µ–Ω, username –±–æ—Ç–∞ –∏ admin_telegram_id, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å¬ª, —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫.</p>
  {% endif %}
</div>

<form action="{{ url_for('support_bot_settings_page') }}" method="post" class="settings-form">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
  <section class="settings-section">
    <h2>Telegram</h2>
    <div class="mb-3 password-wrapper">
      <label class="form-label" for="support_bot_token">–¢–æ–∫–µ–Ω support-–±–æ—Ç–∞</label>
      <div class="d-flex gap-2">
        <input class="form-control" type="password" id="support_bot_token" name="support_bot_token" value="{{ settings.support_bot_token or '' }}" required />
        <button type="button" class="btn btn-outline-secondary toggle-password">üëÅÔ∏è</button>
      </div>
    </div>
    <div class="mb-3">
      <label class="form-label" for="support_bot_username">Username support-–±–æ—Ç–∞ (–±–µ–∑ @)</label>
      <input class="form-control" type="text" id="support_bot_username" name="support_bot_username" value="{{ settings.support_bot_username or '' }}" required />
    </div>
    <div class="mb-3">
      <label class="form-label" for="admin_telegram_id">Telegram ID –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</label>
      <input class="form-control" type="text" id="admin_telegram_id" name="admin_telegram_id" value="{{ settings.admin_telegram_id or '' }}" required />
    </div>
  </section>

  <section class="settings-section">
    <h2>–ì—Ä—É–ø–ø–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</h2>
    <div class="mb-3">
      <label class="form-label" for="support_forum_chat_id">ID —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (forum chat id)</label>
      <input class="form-control" type="text" id="support_forum_chat_id" name="support_forum_chat_id" value="{{ settings.support_forum_chat_id or '' }}" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, -1001234567890" />
      <div class="form-hint">–ì—Ä—É–ø–ø–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–æ–π —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º–∏ —Ç–µ–º–∞–º–∏, –±–æ—Ç ‚Äî –∞–¥–º–∏–Ω.</div>
    </div>
  </section>

  <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</form>
{% endblock %}
